{% from 'bootstrap5/utils.html' import render_icon %}

{% if from_popup %}

{% extends "main.html" %}
{% from 'bootstrap5/utils.html' import render_messages %}
{% block title %}Pretty code{% endblock %}

{%endif%}


{% block content %}

{% if from_popup %}
<center><button class="btn btn-primary goBack" type="button">Go Back</button></center>
{%endif%}

<script type="module">
    async function getData() {
      const url = "{{download_link}}";
      try {
        const response = await fetch(url);
        if (!response.ok) {
          throw new Error(`Response status: ${response.status}`);
        }

        const result_text = await response.text();
        try {
            const data = JSON.parse(result_text);
            $('#json-renderer').jsonViewer(data, {withLinks: false});
        } catch(error) {
          document.getElementById("json-renderer").innerHTML = encodeURIComponent(result_text);
        }
      } catch (error) {
        console.error(error.message);
        document.getElementById("json-renderer").innerHTML = "The POST request failed.";
      }
    }
    await getData()
</script>

<center>
  <a href="{{ download_link }}">
      Download content
  </a>
</center>

<pre id="json-renderer", style="text-wrap: wrap; word-break: break-word;"></pre>

{% endblock %}
